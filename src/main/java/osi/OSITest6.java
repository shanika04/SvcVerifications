package osi;import org.owasp.esapi.codecs.WindowsCodec;import org.owasp.esapi.ESAPI;import org.owasp.esapi.codecs.UnixCodec;import java.io.IOException;public class OSITest6 {  public void test(String data) throws IOException, InterruptedException {    Inner inner = new Inner(encodeForOS(data));    doStuff("mkdir", inner);  }  private void doStuff(String command, Inner inner) throws IOException, InterruptedException {    /* POTENTIAL FLAW: command injection */    Process process = Runtime.getRuntime().exec(command + inner.getSuperInner());    process.waitFor();  }  private String encodeForOS(String param) {    if (System.getProperty("os.name").toLowerCase().indexOf("win") >= 0) {      return ESAPI.encoder().encodeForOS(new WindowsCodec(), param);    } else {      return ESAPI.encoder().encodeForOS(new UnixCodec(), param);    }  }  public static class Inner {    private String superInner;    public Inner(String superInner) {      this.superInner = superInner;    }    public String getSuperInner() {      return superInner;    }  }}