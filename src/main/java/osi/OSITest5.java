package osi;import org.owasp.esapi.codecs.WindowsCodec;import org.owasp.esapi.codecs.UnixCodec;import org.owasp.esapi.ESAPI;import java.io.IOException;public class OSITest5 {  private String data;  public void test(String data) throws IOException, InterruptedException {    this.data = encodeForOS(data);    doStuff("mkdir");  }  private void doStuff(String command) throws InterruptedException, IOException {    /* POTENTIAL FLAW: command injection */    Process process = Runtime.getRuntime().exec(command + data);    process.waitFor();  }  private String encodeForOS(String param) {    if (System.getProperty("os.name").toLowerCase().indexOf("win") >= 0) {      return ESAPI.encoder().encodeForOS(new WindowsCodec(), param);    } else {      return ESAPI.encoder().encodeForOS(new UnixCodec(), param);    }  }}